<article @php(post_class())>
    <header>
        {{-- TODO --}}
        <img src="{{ get_the_post_thumbnail_url() }}" alt="{{ get_the_title() }}">
        <div class="taxonomies">
            @foreach (get_the_category() as $category)
                @if ($category->term_id !== 1)
                    <a href="{{ get_category_link($category->term_id) }}" class="category">{{ $category->name }}</a>
                @endif
            @endforeach
        </div>
        <h1> {{ $title }} </h1>
        {{-- TODO: mettre des couleurs --}}
        <div class="infos">
            <p class="update">
                <span class="label">Mise à jour le : </span>
                {{-- <span class="value">10 sept. 2023</span> --}}
                <span class="value">{{ get_the_modified_date('j F Y') }}</span>
            </p>
            |
            <p class="temps-de-lecture">
                <span class="label">Temps de lecture estimé : </span>
                <span class="value">{{ get_field('temps_de_lecture') }} min</span>
            </p>
        </div>
        @if (get_field('document_mis_en_avant')['visible'])
            <div class="document">
                <p>{{ get_field('document_mis_en_avant')['titre'] }}</p>
                <a class="bouton bouton-violet bouton-petit"
                    href="{{ get_field('document_mis_en_avant')['bouton']['url'] }}" download>
                    {{ get_field('document_mis_en_avant')['bouton']['title'] }}
                </a>
            </div>
        @endif
        <div class="like{{ is_user_logged_in() ? ' add-like' : '' }}"
            data-admin-ajax="{{ admin_url('admin-ajax.php') }}" data-post-id="{{ get_the_ID() }}">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                <g clip-path="url(#clip0_1469_2006)">
                    <path
                        d="M18.0556 24C17.8044 24 17.5532 23.983 17.2934 23.9404C15.007 23.6 12.0883 23.1064 9.27356 22.6383C6.0864 22.1021 3.07246 21.6 1.19307 21.3447C0.812001 21.2936 0.526196 20.9787 0.526196 20.6043C0.500214 18.6553 0.526196 12.2468 0.526196 12.1872C0.526196 11.8213 0.794679 11.5064 1.15843 11.4383L5.12506 10.7234C5.99113 10.5702 6.75328 10.0596 7.2123 9.33618C8.26891 7.67661 9.71526 5.03831 10.5467 1.9064C10.8238 0.800013 11.7592 0.0595872 12.9111 1.27351e-05C14.037 -0.0510511 15.0243 0.587247 15.414 1.64257C15.7258 2.49363 15.8038 3.54895 15.6392 4.69789C15.3967 6.36597 15.0676 7.96597 14.8597 8.88512L20.2814 9.76171C21.5285 9.93193 22.5245 10.6638 22.8623 11.6851C23.0701 12.2894 23.0095 12.9192 22.7237 13.4894C23.0961 13.8894 23.2953 14.4851 23.2693 15.183C23.2434 15.9404 22.9402 16.7319 22.4033 17.2341C22.6977 17.9149 22.6631 18.7575 22.3859 19.4553C22.1434 20.0851 21.7191 20.5532 21.2167 20.8C21.3466 21.4043 21.2427 22.0341 20.8963 22.5958C20.342 23.5064 19.3027 24.0085 18.0382 24.0085M2.05915 19.9234C3.95585 20.1958 6.67533 20.6553 9.52472 21.1319C12.3395 21.6085 15.2495 22.0936 17.5186 22.4341C18.4799 22.5787 19.2507 22.3404 19.5799 21.8043C19.7964 21.4468 19.7704 21.0213 19.5106 20.6724C19.32 20.4255 19.3027 20.0851 19.4673 19.8213C19.6318 19.5575 19.9436 19.4128 20.2554 19.4638C20.6451 19.5319 20.8616 19.1404 20.9483 18.9021C21.1648 18.3489 21.0608 17.7702 20.8183 17.6255C20.5412 17.4553 20.4026 17.1234 20.4806 16.8085C20.5499 16.4936 20.8183 16.2553 21.1475 16.2213C21.3986 16.1958 21.7017 15.7021 21.7277 15.1149C21.7277 14.9021 21.6931 14.4851 21.4766 14.4511C21.1908 14.4 20.9656 14.1958 20.879 13.9234C20.7924 13.6511 20.8703 13.3617 21.0782 13.1575C21.4073 12.8426 21.5199 12.4936 21.3986 12.1532C21.2427 11.7021 20.7144 11.3447 20.0562 11.2596L13.8031 10.2553C13.5866 10.2213 13.4047 10.1021 13.2835 9.92342C13.1622 9.74469 13.1276 9.53193 13.1796 9.32767C13.1796 9.30214 13.7598 6.93618 14.1149 4.48512C14.2448 3.5915 14.1929 2.77448 13.9677 2.17023C13.7338 1.54895 13.1622 1.52342 12.989 1.53193C12.6253 1.54895 12.1836 1.7532 12.0363 2.28937C11.1529 5.60852 9.63731 8.3915 8.52007 10.1447C7.82721 11.2255 6.69265 11.983 5.39354 12.2213L2.05915 12.8255C2.05915 14.3064 2.04183 18.0085 2.05915 19.9319"
                        fill="#A71681" />
                </g>
                <defs>
                    <clipPath id="clip0_1469_2006">
                        <rect width="22.7778" height="24" fill="white" transform="translate(0.5)" />
                    </clipPath>
                </defs>
            </svg>
            <?php
            $likes = get_post_meta(get_the_ID(), 'likes_count', true) ?: 0;
            ?>
            <p class="like-number like-count-{{ get_the_ID() }}">{{ $likes }}</p>
        </div>
    </header>
    <aside>
        {{-- TODO --}}
        <nav>
            {{-- TODO menu --}}
        </nav>
    </aside>
    <section id="article-content" class="max-w-5xl mx-auto px-6">
        @if (get_field('contenu'))
            @foreach (get_field('contenu') as $section)
                @php($component = 'components.article.' . $section['acf_fc_layout'])
                @if (View::exists($component))
                    @include($component, ['section' => $section])
                @else
                    <!-- Le composant "<?= $component ?>" n'est pas implémenté -->
                @endif
            @endforeach
        @endif
    </section>
    <section id="like-article">
        <header>
            <h2>Vous avez aimé cet article ?</h2>
            <div class="like{{ is_user_logged_in() ? ' add-like' : '' }}"
                data-admin-ajax="{{ admin_url('admin-ajax.php') }}" data-post-id="{{ get_the_ID() }}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                    fill="none">
                    <g clip-path="url(#clip0_1469_2006)">
                        <path
                            d="M18.0556 24C17.8044 24 17.5532 23.983 17.2934 23.9404C15.007 23.6 12.0883 23.1064 9.27356 22.6383C6.0864 22.1021 3.07246 21.6 1.19307 21.3447C0.812001 21.2936 0.526196 20.9787 0.526196 20.6043C0.500214 18.6553 0.526196 12.2468 0.526196 12.1872C0.526196 11.8213 0.794679 11.5064 1.15843 11.4383L5.12506 10.7234C5.99113 10.5702 6.75328 10.0596 7.2123 9.33618C8.26891 7.67661 9.71526 5.03831 10.5467 1.9064C10.8238 0.800013 11.7592 0.0595872 12.9111 1.27351e-05C14.037 -0.0510511 15.0243 0.587247 15.414 1.64257C15.7258 2.49363 15.8038 3.54895 15.6392 4.69789C15.3967 6.36597 15.0676 7.96597 14.8597 8.88512L20.2814 9.76171C21.5285 9.93193 22.5245 10.6638 22.8623 11.6851C23.0701 12.2894 23.0095 12.9192 22.7237 13.4894C23.0961 13.8894 23.2953 14.4851 23.2693 15.183C23.2434 15.9404 22.9402 16.7319 22.4033 17.2341C22.6977 17.9149 22.6631 18.7575 22.3859 19.4553C22.1434 20.0851 21.7191 20.5532 21.2167 20.8C21.3466 21.4043 21.2427 22.0341 20.8963 22.5958C20.342 23.5064 19.3027 24.0085 18.0382 24.0085M2.05915 19.9234C3.95585 20.1958 6.67533 20.6553 9.52472 21.1319C12.3395 21.6085 15.2495 22.0936 17.5186 22.4341C18.4799 22.5787 19.2507 22.3404 19.5799 21.8043C19.7964 21.4468 19.7704 21.0213 19.5106 20.6724C19.32 20.4255 19.3027 20.0851 19.4673 19.8213C19.6318 19.5575 19.9436 19.4128 20.2554 19.4638C20.6451 19.5319 20.8616 19.1404 20.9483 18.9021C21.1648 18.3489 21.0608 17.7702 20.8183 17.6255C20.5412 17.4553 20.4026 17.1234 20.4806 16.8085C20.5499 16.4936 20.8183 16.2553 21.1475 16.2213C21.3986 16.1958 21.7017 15.7021 21.7277 15.1149C21.7277 14.9021 21.6931 14.4851 21.4766 14.4511C21.1908 14.4 20.9656 14.1958 20.879 13.9234C20.7924 13.6511 20.8703 13.3617 21.0782 13.1575C21.4073 12.8426 21.5199 12.4936 21.3986 12.1532C21.2427 11.7021 20.7144 11.3447 20.0562 11.2596L13.8031 10.2553C13.5866 10.2213 13.4047 10.1021 13.2835 9.92342C13.1622 9.74469 13.1276 9.53193 13.1796 9.32767C13.1796 9.30214 13.7598 6.93618 14.1149 4.48512C14.2448 3.5915 14.1929 2.77448 13.9677 2.17023C13.7338 1.54895 13.1622 1.52342 12.989 1.53193C12.6253 1.54895 12.1836 1.7532 12.0363 2.28937C11.1529 5.60852 9.63731 8.3915 8.52007 10.1447C7.82721 11.2255 6.69265 11.983 5.39354 12.2213L2.05915 12.8255C2.05915 14.3064 2.04183 18.0085 2.05915 19.9319"
                            fill="#A71681" />
                    </g>
                    <defs>
                        <clipPath id="clip0_1469_2006">
                            <rect width="22.7778" height="24" fill="white" transform="translate(0.5)" />
                        </clipPath>
                    </defs>
                </svg>
                <?php
                $likes = get_post_meta(get_the_ID(), 'likes_count', true) ?: 0;
                ?>
                <p class="like-number like-count-{{ get_the_ID() }}">{{ $likes }}</p>
            </div>
        </header>
        <div class="content">
            <div class="bouton bouton-bordure{{ is_liked_by_user(get_the_ID()) ? ' active' : '' }}{{ is_user_logged_in() ? ' add-like' : '' }} like-bouton-{{ get_the_ID() }}"
                data-admin-ajax="{{ admin_url('admin-ajax.php') }}" data-post-id="{{ get_the_ID() }}">
                OUI</div>
            <div class="bouton bouton-bordure{{ is_user_logged_in() ? ' add-like' : '' }}"
                data-admin-ajax="{{ admin_url('admin-ajax.php') }}" data-post-id="{{ get_the_ID() }}"
                data-only-remove>NON</div>
        </div>
    </section>
    <section id="article-comments">
        {{-- TODO --}}
        @php(comments_template())
    </section>
</article>
